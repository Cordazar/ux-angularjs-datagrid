/*
* uxListView v.0.1.0
* (c) 2013, WebUX
* License: MIT.
*/
!function(a){function b(a,b,c){function d(a,b){var c,d;d=h[a],d&&(b?(c=d.indexOf(b),-1!==c&&d.splice(c,1)):d.length=0)}function e(a,b){return h[a]=h[a]||[],h[a].push(b),function(){d(a,b)}}function f(b,c){return b&&b.apply(a,c)}function g(a){if(h[a])for(var b=0,c=h[a],d=c.length;d>b;)f(c[b],arguments),b+=1}var h={};b&&c?(a.on=b[c.on]&&b[c.on].bind(b),a.off=b[c.off]&&b[c.off].bind(b),a.dispatch=b[c.dispatch].bind(b)):(a.on=e,a.off=d,a.dispatch=g)}function c(a){for(var b=[],c=0,d=a.length;d>c;)b.push(a[c]),c+=1;return b}!function(){"use strict";angular.module("addons",[]).factory("addons",["$injector",function(a){function b(b,c){for(var d,e=0,f=b.length;f>e;){if(d=a.get(b[e]),"function"!=typeof d)throw new Error("Addons expect a function to pass the grid instance to.");d(c),e+=1}}return function(a,c){c=c instanceof Array?c:c&&c.split(",")||[],a.addons&&(c=a.addons=a.addons.concat(c)),b(c,a)}}])}(),a.util=a.util||{},a.util.array=a.util.array||{},a.util.array.toArray=c,function(){"use strict";var a=function(){};a.prototype=Array.prototype,a.prototype.min=0,a.prototype.max=0,a.prototype.templateStart="",a.prototype.templateEnd="",a.prototype.getStub=function(a){return this.templateStart+a+this.templateEnd},a.prototype.getChildrenStr=function(b){for(var c=0,d=this.length,e="",f=this;d>c;)e+=f[c]instanceof a?f[c].getStub(b?f[c].getChildrenStr(b):""):this.templateModel.getTemplate(f[c]).template,c+=1;return this.rendered=!0,e},ux.listView.coreAddons.chunkModel=function(c){function d(){return l}function e(b,d,g,h){for(var i,j,k=0,l=b.length,m=new a;l>k;)j=b[k],k%d===0&&(i&&f(i),i=new a,i.min=j.min||k,i.templateModel=c.templateModel,i.templateStart=g,i.templateEnd=h,m.push(i)),i.push(j),i.max=j.max||k,k+=1;return f(i),m.min||(m.min=m[0].min,m.max=m[m.length-1].max,m.templateStart=g,m.templateEnd=h,f(m)),m.length>d?e(m,d,g,h):m}function f(b){if(b[0]instanceof a){for(var d=0,e=b.length,f=0;e>d;)f+=b[d].height,d+=1;b.height=f}else b.height=c.templateModel.getHeight(m,b.min,b.max);b.templateStart=b.templateStart.substr(0,b.templateStart.length-1)+' style="width:100%;height:'+b.height+'px;">'}function g(a,b,c,d,f){return o=f,n=b,m=a,l=e(a,b,c,d),f}function h(b,c,d){var e,f=0,g=c.length;for(d=d||[];g>f;){if(e=c[f],!(e instanceof a)){d.push(b%n);break}if(b>=e.min&&b<=e.max){d.push(f),h(b,e,d);break}f+=1}return d}function i(a){var b=h(a,l);return j(b)}function j(a){for(var b,c=0,d=a.slice(0),e=l,f=o;c<d.length;)b=d.shift(),e.rendered||(f.innerHTML=e.getChildrenStr()),e=e[b],f=f.childNodes[b];return f}function k(){o&&(o.innerHTML=""),l=null,n=null,o=null}var l,m,n,o,p={};return p.chunkDom=g,p.getChunkList=d,p.getRowIndexes=function(a){return h(a,l)},p.getRow=i,p.reset=k,b(p),c.chunkModel=p,p},ux.listView.coreAddons.push(ux.listView.coreAddons.chunkModel)}(),ux.listView.events.RENDER_PROGRESS="listView:renderProgress",ux.listView.coreAddons.push(function(a){function b(b){var c=a.scopes[b];c&&c.digested||a.forceRenderScope(b)}function c(c,f){for(var g=c,j=f,k=Date.now()+a.options.renderThreshold;k>Date.now()&&(g>0||j<a.rowsLength);)g>=0&&(b(g),g-=1),j<a.rowsLength&&(b(j),j+=1);h=a.scopes.length/a.rowsLength,d(),i+=1,!a.values.speed&&a.scopes.length<a.rowsLength&&e(g,j),a.dispatch(ux.listView.events.RENDER_PROGRESS,h)}function d(){clearTimeout(g),g=0}function e(b,e){d(),j>i&&(g=setTimeout(c,a.options.renderThreshold,b,e))}function f(a,b){g||(i=0,e(b.started,b.ended))}var g=0,h=0,i=0,j=10;a.unwatchers.push(a.scope.$on(ux.listView.events.BEFORE_UPDATE_WATCHERS,d)),a.unwatchers.push(a.scope.$on(ux.listView.events.AFTER_UPDATE_WATCHERS,f))}),ux.listView.coreAddons.push(function(a){function b(a,c,d){var e=0,f=a.length;for(d=d||[];f>e;)d.push(a[e]),a[e]&&a[e][c]&&b(a[e][c],c,d),e+=1;return d}var c,d;return a.setData=function(a,e){return c=a,d=e?b(a,e):a},a.getData=function(){return d},a.getOriginalData=function(){return c},a}),ux.listView.coreAddons.push(function(a){a.setupScrolling=function(){a.element[0].addEventListener("scroll",a.onUpdateScroll),a.unwatchers.push(function(){a.element[0].removeEventListener("scroll",a.onUpdateScroll)})},a.onUpdateScroll=function(b){var c=(b.target||b.srcElement||a.element[0]).scrollTop;a.values.scroll!==c&&(a.values.speed=c-a.values.scroll,a.values.absSpeed=Math.abs(a.values.speed),a.values.scroll=c),a.waitForStop()},a.scrollTo=function(b){a.element[0].scrollTop=b,a.waitForStop()},a.waitForStop=function(){clearTimeout(a.values.scrollingStopIntv),a.values.scrollingStopIntv=setTimeout(a.onScrollingStop,a.options.updateDelay)},a.onScrollingStop=function(){a.flow.log("scrollingStop"),a.values.speed=0,a.values.absSpeed=0,a.flow.add(a.render)}}),ux.listView.events.STATS_UPDATE="ux-listView:statsUpdate",ux.listView.coreAddons.push(function(a){function b(){h=Date.now()}function c(){l.initialRenderTime=Date.now()-h,d()}function d(){for(;k.length;)k.pop()()}function e(){j.push(Date.now())}function f(){var a=j.length-1;j[a]=Date.now()-j[a],i+=j[a],g()}function g(){l.renders=j.length,l.averageRenderTime=i/l.renders,a.dispatch(ux.listView.events.STATS_UPDATE,l)}var h=0,i=0,j=[],k=[],l={initialRenderTime:0,averageRenderTime:0};k.push(a.scope.$on(ux.listView.events.INIT,b)),k.push(a.scope.$on(ux.listView.events.READY,c)),a.unwatchers.push(a.scope.$on(ux.listView.events.BEFORE_UPDATE_WATCHERS,e)),a.unwatchers.push(a.scope.$on(ux.listView.events.AFTER_UPDATE_WATCHERS,f)),a.stats=l}),ux.listView.coreAddons.push(function(a){"use strict";function b(a){return a=a.replace(/\n/g,""),a=a.replace(/[\t ]+</g,"<"),a=a.replace(/>[\t ]+</g,"><"),a=a.replace(/>[\t ]+$/g,">")}a.templateModel=function(){function c(){var b,c=a.element[0].getElementsByTagName("script"),e=c.length;for(b=0;e>b;b+=1)d(c[b]);for(;c.length;)a.element[0].removeChild(c[0])}function d(c){var d,e=b(angular.element(c).html()),f=document.createElement("div");return e=angular.element(e)[0],e.className+=" "+a.options.uncompiledClass+" {{$status}}",f.appendChild(e),document.body.appendChild(f),e=b(f.innerHTML),d={name:c.attributes["data-template-name"].nodeValue||"default",item:c.attributes["data-template-item"].nodeValue,template:e,height:f.offsetHeight},n[d.name]=d,document.body.removeChild(f),m=0,d}function e(a){return f(a._template)}function f(a){return n[a]?n[a]:n["default"]}function g(){var a,b;for(a in n)if(n.hasOwnProperty(a)&&(b=b||n[a].height,b!==n[a].height))return!0;return!1}function h(){var a=0,b=n.length;if(!m)for(;b>a;)m+=n[a].height,a+=1;return m/b}function i(){return j(n)}function j(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&(c+=1);return c}function k(a){return e(a).height}function l(a,b,c){for(var d=b,e=0;c>=d;)e+=k(a[d]),d+=1;return e}var m,n={};return{createTemplates:c,getTemplate:e,getTemplateByName:f,templateCount:i,dynamicHeights:g,averageTemplateHeight:h,getHeight:l,getTemplateHeight:k}}()}),function(){"use strict";angular.module("ux").factory("iosScrollFrictionAddon",function(){return function(a){var b=a,c=b.values,d=b.flow,e=.95,f=1,g=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1;g&&(b.setupScrolling=function(){d.log("scrollFriction:setupScrolling"),b.options.updateDelay=10,b.element[0].addEventListener("scroll",b.onUpdateScroll),b.unwatchers.push(function(){b.element[0].removeEventListener("scroll",b.onUpdateScroll)})},b.onUpdateScroll=function(a){d.log("scrollFriction:onUpdateScroll");var e=(a.target||a.srcElement||b.element[0]).scrollTop;c.scroll!==e&&(c.speed=e-c.scroll,c.absSpeed=Math.abs(c.speed),c.scroll=e),b.waitForStop()},b.scrollTo=function(a){b.element[0].scrollTop=a,b.waitForStop()},b.waitForStop=function(){d.log("scrollFriction:waitForStop"),clearTimeout(c.scrollingStopIntv),c.scrollingStopIntv=setTimeout(b.onScrollingStop,b.options.updateDelay)},b.onScrollingStop=function(){d.log("scrollFriction:scrollingStop"),c.absSpeed>f?b.applyScrollFriction():(c.speed=0,c.absSpeed=0,d.add(b,b.render))},b.applyScrollFriction=function(){var b=0;c.absSpeed>f&&(b=c.speed*e),b&&(a.element[0].scrollTop+=b)})}})}()}(this.ux=this.ux||{},function(){return this}());