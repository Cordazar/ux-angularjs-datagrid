/*!
* ux-angularjs-datagrid v.1.4.6
* (c) 2016, Obogo
* https://github.com/obogo/ux-angularjs-datagrid
* License: MIT.
*/
(function (exports, global) {
if (typeof define === "function" && define.amd) {
  define(exports);
} else if (typeof module !== "undefined" && module.exports) {
  module.exports = exports;
} else {
  global.ux = exports;
}


function charPack(a,b){for(var c="";c.length<b;)c+=a;return c}function each(a,b,c){var d,e,f,g=0,h=exports.util.apply;if(arguments.length>2&&(f=exports.util.array.toArray(arguments),f.splice(0,2)),a&&a.length)for(d=a.length;d>g;){if(e=h(b,null,[a[g],g,a].concat(f)),void 0!==e)return e;g+=1}else if(a&&h(Object.prototype.hasOwnProperty,a,["0"]))for(;h(Object.prototype.hasOwnProperty,a,[g]);){if(e=h(b,null,[a[g],g,a].concat(f)),void 0!==e)return e;g+=1}else if(!(a instanceof Array))for(g in a)if(h(Object.prototype.hasOwnProperty,a,[g])&&(e=h(b,null,[a[g],g,a].concat(f)),void 0!==e))return e;return a}function filter(a,b,c){var d,e,f,g=0,h=[],i=exports.util.apply;if(arguments.length>2&&(e=exports.util.array.toArray(arguments),e.splice(0,2)),a&&a.length)for(d=a.length;d>g;)f=i(b,null,[a[g],g,a].concat(e)),f&&h.push(a[g]),g+=1;else for(g in a)i(Object.prototype.hasOwnProperty,a,[g])&&(f=i(b,null,[a[g],g,a].concat(e)),f&&h.push(a[g]));return h}function extend(a,b){for(var c,d,e=exports.util.array.toArray(arguments),f=1,g=e.length;g>f;){c=e[f];for(d in c)a[d]&&"object"==typeof a[d]?a[d]=extend(a[d],c[d]):c[d]instanceof Array?a[d]=extend([],c[d]):c[d]&&"object"==typeof c[d]?a[d]=extend({},c[d]):a[d]=c[d];f+=1}return a}function Flow(a,b,c,d){function e(a){return a.toString().split(/\b/)[2]}function f(a,b,c){return{label:e(a),method:a,args:b||[],delay:c}}function g(a){var b=e(a);G[b]=a}function h(b){for(var c=0,e=D.length;e>c;)D[c].label===b.label&&(D[c]===C&&A?(d.cancel(A),A=null,C=null,a.warn("REMOVE ACTIVE FLOW ITEM %c%s",I,b.label)):a.info("remove Flow item %c%s",I,b.label),D.splice(c,1),c-=1,e-=1),c+=1;C||r()}function i(a,b,c){var d=f(a,b,c);G[d.label]&&h(d),D.push(d),B&&r()}function j(a,b,c){D.splice(1,0,f(a,b,c))}function k(a){h({label:e(a)})}function l(b,c){var d,e=f(b,[]),g=Date.now(),h=function(){a.log("exec timeout method %c%s %sms (len:%s)",I,e.label,Date.now()-g,D.length),D.push(e),B&&r()};return a.log("wait for timeout method %c%s (len:%s)",I,e.label,D.length),d=setTimeout(h,c),H[d]=function(){clearTimeout(d),delete H[d]},d}function m(a){H[a]&&H[a]()}function n(a){var b=a.toString(),c=b.match(/\(.*\)/);return c[0].match(/([\$\w])+/gm)}function o(a){var b=n(a);return!(!b||-1===b.indexOf("done"))}function p(){return z=Date.now(),a.log("finish %c%s took %dms (len:%s)",I,C.label,z-y,D.length),C=null,q(D.shift()),r(),z-y}function q(a){for(E.unshift(a);E.length>F;)E.pop()}function r(){a.log("next %s",D.length),!C&&D.length&&(C=D[0],a.async&&void 0!==C.delay?(a.log("	delay for %c%s %sms (len:%s)",I,C.label,C.delay,D.length),A=d(s,C.delay,!1)):s())}function s(){if(a){if(A&&d.cancel(A),c&&c())return a.warn("	wait for pauseFn"),void(A=d(s,0,!1));var b=o(C.method);a.log("start method %c%s (len:%s)"+(b&&" - (has done arg)"||""),I,C.label,D.length),b&&C.args.push(p);try{y=Date.now(),exports.util.apply(C.method,null,C.args)}catch(e){a.warn(e.message+"\n"+(e.stack||e.stacktrace||e.backtrace))}finally{b||p()}}}function t(){B=!0,r()}function u(){var b,c=C?1:0;for(a.info("clear");D.length>c;)b=D.splice(c,1)[0],a.log("	remove %s from flow",b.label)}function v(){return D.length}function w(a){for(var b=0,c=0;c<D.length;c+=1)D[c].label===a&&(b+=1);return b}function x(){D.length=0,a=null}var y,z,A,B=!1,C=null,D=[],E=[],F=10,G={},H={},I="color:#666666;";return exports.logWrapper("Flow",a,"grey",a),a.debug=exports.util.apply(Object.prototype.hasOwnProperty,a,["debug"])?a.debug:0,a.insert=j,a.add=i,a.unique=g,a.remove=k,a.timeout=l,a.stopTimeout=m,a.run=t,a.clear=u,a.length=v,a.count=w,a.destroy=x,a}function Datagrid(a,b,c,d,e){function f(a){a.stopImmediatePropagation(),a.stopPropagation()}function g(){b.on("touchstart",f),b.on("touchmove",f),b.on("touchend",f),b.on("touchcancel",f),b.on("mousedown",f),b.on("mouseup",f),b.on("click",f),Fa.unique(xa),Fa.unique(ma),Fa.unique(ca)}function h(){return!(!a||!a.$$phase)}function i(){Xa.uid=exports.uid(),Xa.name=a.$eval(c.gridName)||"datagrid",Xa.scope=a,Xa.element=b,Xa.attr=c,Xa.rowsLength=0,Xa.scopes=Na,Xa.data=Xa.data||[],Xa.unwatchers=Ma,Xa.values=Va,Xa.start=n,Xa.update=na,Xa.reset=xa,Xa.isReady=v,Xa.isStartupComplete=q,Xa.forceRenderScope=ya,Xa.dispatch=Ba,Xa.activateScope=Z,Xa.deactivateScope=Y,Xa.updateLinks=fa,Xa.render=function(){Fa.add(ma)},Xa.updateHeights=Aa,Xa.getOffsetIndex=_,Xa.isActive=$,Xa.isCompiled=E,Xa.swapItem=y,Xa.moveItem=z,Xa.getScope=A,Xa.getRowItem=B,Xa.getRowElm=C,Xa.getExistingRow=D,Xa.getRowIndex=Xa.getIndexOf=F,Xa.getRowOffset=H,Xa.getRowHeight=I,Xa.getViewportHeight=J,Xa.getContentHeight=K,Xa.getContent=m,Xa.isDigesting=R,Xa.safeDigest=S,Xa.getRowIndexFromElement=G,Xa.updateViewportHeight=u,Xa.calculateViewportHeight=w,Xa.options=Ia=exports.extend({},exports.datagrid.options,a.$eval(c.options)||{}),Xa.flow=Fa=new Flow({async:exports.util.apply(Object.prototype.hasOwnProperty,Ia,["async"])?!!Ia.async:!0,debug:exports.util.apply(Object.prototype.hasOwnProperty,Ia,["debug"])?Ia.debug:0},Xa.dispatch,h,e),Xa.grouped=a.$eval(c.grouped),Xa.gc=Ca,Xa.throwError=exports.datagrid.throwError,Fa.add(g),Fa.run()}function j(){var a,c=b[0].getElementsByClassName(Ia.contentClass),d=Ia.contentClass;return c=exports.filter(c,l),a=c[0],a&&(d=a.className||Ia.contentClass),a||(d=k()||d,a=angular.element('<div class="'+d+'"></div>'),Xa.options.chunks.detachDom&&(a[0].style.position="relative"),b.prepend(a)),a[0]||(a=angular.element(a)),a}function k(){var a,b;return Ha?(a=exports.util.array.toArray(Ha[0].classList),b=a.indexOf("old-"+Ia.contentClass),-1!==b&&a.splice(b,1),a.join(" ")):void 0}function l(a,b,c){return angular.element(a).hasClass("old-"+Ia.contentClass)?!1:!0}function m(){return Ga}function n(){Xa.dispatch(exports.datagrid.events.ON_INIT,Xa),Ga=j(),o(0)}function o(a){if(!Xa.element[0].offsetHeight){if(1>a)return void Fa.add(o,[a+1],0);Fa.warn("Datagrid: DOM Element does not have a height.")}Ia.templateModel&&Ia.templateModel.templates&&Fa.add(Xa.templateModel.createTemplatesFromData,[Ia.templateModel.templates],0),Fa.add(Xa.templateModel.createTemplates,null,0),Fa.add(function(){Ia.dynamicRowHeights=Xa.templateModel.dynamicHeights()}),Fa.add(p)}function p(){var b=a.$on(exports.datagrid.events.ON_BEFORE_RENDER_AFTER_DATA_CHANGE,function(){b(),Fa.add(r)});window.addEventListener("resize",x),Ma.push(a.$on(exports.datagrid.events.UPDATE,na)),Ma.push(a.$on(exports.datagrid.events.ON_ROW_TEMPLATE_CHANGE,za)),Ma.push(a.$on("$destroy",Ea)),Fa.add(s,[],0),Xa.dispatch(exports.datagrid.events.ON_LISTENERS_READY)}function q(){return Za}function r(){Za=!0,Ba(exports.datagrid.events.ON_STARTUP_COMPLETE,Xa)}function s(){if(!La){Xa.log("setupChangeWatcher"),La=!0,Ma.push(a.$watchCollection(c.uxDatagrid,t));var b=a.$eval(c.uxDatagrid);b&&b.length&&Fa.add(ma)}}function t(a,b,c){Fa.add(ua,[a,b])}function u(){Ra=Xa.calculateViewportHeight(),Ra||(Ra=Ia.minHeight)}function v(){return Ua===Sa.READY}function w(){return b[0].offsetHeight}function x(a){oa()}function y(a,b,c){var d,e,f=F(a);exports.util.apply(Object.prototype.hasOwnProperty,Xa.data,[f])&&(d=Xa.templateModel.getTemplate(a),e=c?d:Xa.templateModel.getTemplate(b),Xa.normalizeModel.replace(b,f),d!==e?Xa.templateModel.setTemplate(f,e):(Na[f][e.item]=b,S(Na[f])))}function z(a,b){Xa.normalizeModel.move(a,b),wa(Xa.getOriginalData(),Xa.getOriginalData())}function A(a){return Na[a]}function B(a){return this.getData()[a]}function C(a){return angular.element(Xa.chunkModel.getRow(a))}function D(a){return angular.element(Xa.chunkModel.getExistingRow(a))}function E(a){return!!Na[a]}function F(a){return Xa.getNormalizedIndex(a,0)}function G(a){if(a&&b[0].contains(a[0]||a)){a=a.scope?a:angular.element(a);var c=a.scope();for(c===Xa.scope&&Xa.throwError("Unable to get row scope... something went wrong.");c&&c.$parent&&c.$parent!==Xa.scope;)c=c.$parent;return c.$index}return-1}function H(a){return void 0===Qa[a]&&(Ia.dynamicRowHeights?ba():Qa[a]=a*Ia.rowHeight),Qa[a]}function I(a){return Xa.templateModel.getRowHeight(a)}function J(){return Ra}function K(){var a=Xa.chunkModel.getChunkList();return a&&a.height||0}function L(a){Xa.log("OVERWRITE DOM!!!");var b=a.length;Xa.chunkModel.chunkDom(a,Ia.chunks.size,'<div class="'+Ia.chunks.chunkClass+'">',"</div>",Ga),Xa.rowsLength=b,Xa.log("created %s dom elements",b)}function M(a,b){b=b||A(a);var c=A(a-1),d=A(a+1);c&&(c.$$nextSibling=b),b.$$prevSibling=c,b.$$nextSibling=d,b.$$nextSibling&&(b.$$nextSibling.$$prevSibling=b),Na[a]=b}function N(b,c){var e,f=Na[b];return f&&!f.$parent&&(f.$parent=a),f||(!a.$$childTail&&a.$$childHead&&Na[b-1]&&(a.$$childTail=Na[b-1]),f=a.$new(),e=Xa.templateModel.getTemplate(Xa.data[b]),M(b,f),f.$status=Ia.compiledClass,f[e.item]=Xa.data[b],f.$index=b,Na[b]=f,c=c||C(b),c.removeClass(Ia.uncompiledClass),d(c)(f),Xa.templateModel.hasVariableRowHeights()&&Xa.chunkModel.updateAllChunkHeights(b),Xa.dispatch(exports.datagrid.events.ON_ROW_COMPILE,f,c),Y(f,b)),f}function O(a,b){Xa.log("	buildRows %s",a.length),Ua=Sa.BUILDING,L(a),Fa.add(ba,0),v()||Fa.add(P),b&&Fa.add(ma)}function P(){Xa.log("	ready"),Ua=Sa.READY,Fa.add(Q),Fa.add(S,[a])}function Q(){a.$emit(exports.datagrid.events.ON_READY)}function R(a){return!(!a||!a.$$phase)}function S(a){return R(a)?!1:(a.$digest(),!0)}function T(a,b,c){for(;a;){for(var d in b)exports.util.apply(Object.prototype.hasOwnProperty,b,[d])&&c(a,b,d);a=a.$parent}}function U(a,b){T(a,b,V)}function V(a,b,c){a.$$listenerCount[c]+=b[c]}function W(a,b){T(a,b,X)}function X(a,b,c){a.$$listenerCount[c]-=b[c]}function Y(a,b){return a&&!$(a)?(a.$emit(exports.datagrid.events.ON_BEFORE_ROW_DEACTIVATE),a.$$$watchers=a.$$watchers,a.$$watchers=[],a.$$$listenerCount=angular.extend({},a.$$listenerCount),W(a,a.$$listenerCount),b>=0&&(a.$parent=null,a.$$nextSibling=null,a.$$prevSibling=null),!0):!1}function Z(b,c){return b&&b.$$$watchers?(b.$parent=b.$$parent,b.$$watchers=b.$$$watchers,delete b.$$$watchers,U(b,b.$$$listenerCount),delete b.$$$listenerCount,c>=0&&(b.$$nextSibling=Na[c+1],b.$$prevSibling=Na[c-1]),b.$parent=a,b.$emit(exports.datagrid.events.ON_AFTER_ROW_ACTIVATE),!0):!(!b||b.$$$watchers)}function $(a){var b=Na[a];return!(!b||b.$$$watchers)}function _(a){var b=Math.floor(a/Xa.templateModel.averageTemplateHeight()),c=0,d=Xa.rowsLength;if(!a||Xa.rowsLength<2)return c;for(Qa[b]&&Qa[b]<=a&&(c=b);d>c;){if(Qa[c]<=a&&Qa[c+1]>a)return c;c+=1}return c}function aa(){Va.dirty&&Xa.chunkModel.getChunkList()&&Xa.chunkModel.getChunkList().height-Xa.getViewportHeight()<Va.scroll&&(Xa.info("Scroll reset because either there is no data or the scroll is taller than there is scroll area"),Va.scroll=0);var a=Ra,b=Va.scroll>=0?Va.scroll:0,c={startIndex:0,i:0,inc:1,end:Xa.rowsLength,visibleScrollStart:b+Ia.cushion,visibleScrollEnd:b+a-Ia.cushion};return c.startIndex=c.i=Xa.getOffsetIndex(b),Xa.rowsLength&&c.startIndex===c.end&&(c.startIndex=c.i=c.end-1,Xa.log(exports.errors.E1002)),c}function ba(){for(var a,b=0,c=0;c<Xa.rowsLength;)Qa[c]=b,b+=Xa.getRowHeight(c),c+=1;Ia.rowHeight=Xa.rowsLength?Xa.templateModel.getTemplateHeight("default"):0,a=K(),Xa.getContent()[0].style.height=a+"px",Xa.log("heights: viewport %s content %s",Xa.getViewportHeight(),a)}function ca(){var b,c,d,e,f=aa(),g=[].concat(Oa),h=!1;if(!(f.i<0)){for(Xa.dispatch(Ta.ON_BEFORE_UPDATE_WATCHERS,f),ga(),Oa.length=0,Xa.log("	scroll %s visibleScrollStart %s visibleScrollEnd %s",Va.scroll,f.visibleScrollStart,f.visibleScrollEnd);f.i<Xa.rowsLength&&(e=a.$$childHead?Na[f.i-1]:null,b=Xa.getRowOffset(f.i),(b>=f.visibleScrollStart&&b<=f.visibleScrollEnd||f.i===f.startIndex&&f.i<f.end)&&(d=N(f.i),void 0===f.started&&(f.started=f.i),ha(f.i),Z(d,f.i)&&(Xa.getRowElm(f.i).attr("status","active"),c=g.indexOf(f.i),-1!==c&&g.splice(c,1),Oa.push(f.i),S(d,!0)||(h=!0),d.$digested=!0)),f.i+=f.inc,!(f.inc>0&&b>f.visibleScrollEnd||f.inc<0&&b<f.visibleScrollStart)););f.ended=f.i-1,Xa.rowsLength&&Va.activeRange.min<0&&Va.activeRange.max<0&&Xa.throwError(exports.errors.E1002),Xa.log("	startIndex %s endIndex %s",f.startIndex,f.i),ea(g),Pa=f.visibleScrollStart,Xa.log("	activated %s",Oa.join(", ")),fa(),Xa.templateModel.hasVariableRowHeights()&&ba(),Fa.add(da,[f],0),h&&Fa.add(function(){S(a)})}}function da(a){Xa.dispatch(Ta.ON_AFTER_UPDATE_WATCHERS,a)}function ea(a){for(var b,c=[];a.length;)b=a.pop(),c.push(b),Y(Na[b],b),Xa.getRowElm(b).attr("status","inactive");Xa.log("	deactivated %s",c.join(", "))}function fa(){if(Oa.length){var b,c=Oa[Oa.length-1],d=0,e=Oa.length;for(a.$$childHead=Na[Oa[0]],a.$$childTail=Na[c];e>d;)b=Na[Oa[d]],b.$$prevSibling=Na[Oa[d-1]],b.$$nextSibling=Na[Oa[d+1]],b.$parent=a,d+=1}}function ga(){Va.activeRange.min=Va.activeRange.max=-1}function ha(a){Va.activeRange.min=Va.activeRange.min<a&&Va.activeRange.min>=0?Va.activeRange.min:a,Va.activeRange.max=Va.activeRange.max>a&&Va.activeRange.max>=0?Va.activeRange.max:a}function ia(){Va.dirty&&Ba(exports.datagrid.events.ON_BEFORE_RENDER_AFTER_DATA_CHANGE)}function ja(){var a,b;Va.dirty&&Va.activeRange.max>=0&&(Va.dirty=!1,a=Xa.templateModel.calculateRowHeight(C(Va.activeRange.min)[0]),Fa.async&&Xa.getData().length&&a!==(b=Xa.templateModel.getRowHeight(Va.activeRange.min))&&(window.console&&console.warn&&console.warn("Template height change from "+b+" to "+a+". This can cause gaps in the datagrid."),Xa.templateModel.updateTemplateHeights()),Ba(exports.datagrid.events.ON_RENDER_AFTER_DATA_CHANGE))}function ka(){Fa.add(Xa.updateViewportHeight,null,Ka),Fa.add(ma)}function la(){return u(),Ra?(Ka&&Xa.info("datagrid has height of %s.",Ra),Ka=0,!0):(Ka+=1,Ka<Xa.options.readyToRenderRetryMax?(Xa.info("datagrid is waiting for element to have a height."),ka()):Fa.warn("Datagrid: Unable to determine a height for the datagrid. Cannot render. Exiting."),!1)}function ma(){Xa.info("render"),la()?(Ka=0,Xa.log("	render %s",Ua),Ua===Sa.BUILDING?O(Xa.data):Ua===Sa.READY?(Xa.dispatch(exports.datagrid.events.ON_BEFORE_RENDER),Fa.add(ia),Fa.add(ca),Fa.add(ja,[],0),Fa.add(Xa.dispatch,[exports.datagrid.events.ON_AFTER_RENDER])):Xa.throwError(exports.errors.E1001)):Xa.log("	not ready to render.")}function na(){Xa&&Xa.warn("force update"),ua(a.$eval(c.uxDatagrid),Xa.data)||oa()}function oa(){Fa.add(Aa,[],100)}function pa(a,b){if(a&&b&&a.length===b.length){for(var c=0,d=a.length;d>c;){if(qa(a[c],b[c]))return!0;c+=1}return Xa.data.length!==Xa.normalize(a,Xa.grouped).length?(Xa.log("	dirtyCheckData length is different"),!0):!1}return!0}function qa(a,b){return Xa.templateModel.getTemplate(a)!==Xa.templateModel.getTemplate(b)?(Xa.log("	dirtyCheckData row template changed"),!0):!1}function ra(a,b){Xa.log("	mapData()");var c=[];exports.each(Xa.getData(),sa,c),Xa.data=Xa.setData(a,Xa.grouped)||[],Xa.chunkModel.updateList(Xa.data),exports.each(Xa.getData(),ta,c),c=null,Ba(exports.datagrid.events.ON_AFTER_DATA_CHANGE,Xa.data,b)}function sa(a,b,c,d){d[b]=Xa.templateModel.getTemplate(a)}function ta(a,b,c,d){var e,f;Na[b]&&(f=d[b],delete Na[b][f.item],e=Xa.templateModel.getTemplate(a),Na[b][e.item]=a,e!==d[b]&&za({},a,d[b].name,e.name,[],!0))}function ua(b,d){if(Xa.log("onDataChanged"),Xa.grouped=a.$eval(c.grouped),d!==Xa.getOriginalData()&&(d=Xa.getOriginalData()),!Xa.options.smartUpdate||!Xa.data.length||pa(b,d)){var e=Ba(exports.datagrid.events.ON_BEFORE_DATA_CHANGE,b,d);return e.defaultPrevented&&e.newValue&&(b=e.newValue),Va.dirty=!0,Fa.add(wa,[b,d]),!0}return va(b)?(Va.dirty=!0,ra(b,d),Fa.add(Aa,[],0),!0):!1}function va(a){for(var b=0,c=Xa.normalize(a,Xa.grouped),d=a.length;d>b;){if(Xa.data[b]!==c[b])return!0;b+=1}return!1}function wa(a,b){Xa.flow.count("changeData")>1||(Xa.log("	changeData"),Xa.templateModel.clearAllRowHeights(),Ba(exports.datagrid.events.ON_BEFORE_RESET,Xa),Xa.data=Xa.setData(a,Xa.grouped)||[],Ba(exports.datagrid.events.ON_AFTER_DATA_CHANGE,Xa.data,b),xa())}function xa(){Xa.info("reset start"),Fa.clear(),Da(),Qa={},Oa.length=0,Na.length=0,Ga.children().unbind(),Ga.children().remove(),Xa.chunkModel.getChunkList()?(Xa.chunkModel.reset(Xa.data,Ga,Na),Xa.rowsLength=Xa.data.length,Aa()):O(Xa.data,!0),Fa.add(Xa.info,["reset complete"]),Fa.add(Ba,[exports.datagrid.events.ON_AFTER_RESET,Xa])}function ya(b){var c=Na[b];!c&&b>=0&&b<Xa.rowsLength&&(c=N(b)),c&&!a.$$phase&&(Z(c),c.$digest(),Y(c),c.$digested=!0,Xa.templateModel.hasVariableRowHeights()&&(Xa.chunkModel.updateAllChunkHeights(b),ba()))}function za(b,c,d,e,f,g){var h,i=Xa.getNormalizedIndex(c),j=D(i),k=A(i);if(k&&k!==a){for(h=angular.element(Xa.templateModel.getTemplateByName(e).template),h.addClass(Ia.uncompiledClass);f&&f.length;)h.addClass(f.shift());j.parent()[0].replaceChild(h[0],j[0]),Z(k),M(i,k),j.remove(),k.$destroy(),Na[i]=null,g||(Xa.chunkModel.updateRow(i,c),Aa(i))}}function Aa(a){Fa.add(u),Fa.add(Xa.chunkModel.updateAllChunkHeights,[a]),Fa.add(ba),Fa.add(u),Fa.add(function(){var a=Xa.getContentHeight()-Xa.getViewportHeight();Va.scroll>a&&(Va.scroll=a)}),Fa.add(Xa.dispatch,[exports.datagrid.events.ON_AFTER_HEIGHTS_UPDATED]),Fa.add(ma),Fa.add(Xa.dispatch,[exports.datagrid.events.ON_AFTER_HEIGHTS_UPDATED_RENDER])}function Ba(b){return Ia.debug&&Ya.log("$emit %s",b),exports.util.apply(a.$emit,a,arguments)}function Ca(){clearInterval(Ja),Xa.shuttingDown||(Ja=setTimeout(function(){if(Xa){Xa.info("GC");var a,b,c=524288;for(b=0;c>b;b+=1)a=.5}},5e3))}function Da(){var b,c,d=0;each(Na,function(a,e){if(a){for(a.$$prevSibling=b||void 0,d=e;!c&&d<Xa.rowsLength;)d+=1,c=Na[d]||void 0;Z(a),b=a,a.$destroy()}}),a.$$childHead=void 0,a.$$childTail=void 0,Na.length=0}function Ea(){for(b.off("touchstart",f),b.off("touchmove",f),b.off("touchend",f),b.off("touchcancel",f),b.off("mousedown",f),b.off("mouseup",f),b.off("click",f),Xa.shuttingDown=!0,m()[0].style.display="none",a.datagrid=null,Xa.log("destroying grid"),window.removeEventListener("resize",x),clearTimeout(Va.scrollingStopIntv),Fa.destroy(),Xa.flow=void 0,Fa=null;Ma.length;)Ma.pop()();Xa.destroyLogger();for(var e in Xa)Xa[e]&&Xa[e].hasOwnProperty("destroy")&&(Xa[e].destroy(),Xa[e]=null);Da(),b.remove(),delete a.$parent[Xa.name],Qa=null,Xa=null,a=null,b=null,c=null,Ma=null,Ga=null,Oa.length=0,Oa=null,Na.length=0,Na=null,Va=null,Sa=null,Ta=null,Ia=null,Wa=null,d=null}var Fa,Ga,Ha,Ia,Ja,Ka=0,La=!1,Ma=[],Na=[],Oa=[],Pa=0,Qa={},Ra=0,Sa=exports.datagrid.states,Ta=exports.datagrid.events,Ua=Sa.BUILDING,Va={dirty:!1,scroll:0,speed:0,absSpeed:0,scrollPercent:0,touchDown:!1,scrollingStopIntv:null,activeRange:{min:0,max:0}},Wa=[exports.datagrid.events.LOG,exports.datagrid.events.INFO,exports.datagrid.events.WARN,exports.datagrid.events.ERROR],Xa=this,Ya={},Za=!1;return exports.logWrapper("datagrid event",Xa,"grey",Xa),exports.logWrapper("datagrid",Xa,"green",Xa),exports.logWrapper("events",Ya,"light",Xa),a.datagrid=Xa,i(),Xa}function getRowIndexFromIndexes(a,b){var c=0;"string"==typeof a&&(a=a.split("."));for(var d=0;d<a.length;d+=1)a[d]=parseInt(a[d],10),c+=d<a.length-1?a[d]*b:a[d];return c}function ChunkArray(a){this.uid=ChunkArray.uid++,this.enabled=!0,this.min=0,this.max=0,this.templateStart="",this.templateStartWithPos="",this.templateEnd="",this.parent=null,this.mode=a?ChunkArray.DETACHED:ChunkArray.ATTACHED,this.detachDom=a,this.index=0}!function(a,b){b.util=a;var c,d,e=function(){};!function(){var a,b,f,g,h,i="~",j=".";return a=Function[i]=Function[i]||function(b){return a[b]||(a[b]={}),a[b]},g=a("c"),b=a("d"),f=a("p"),h=function(a){var c=arguments,d=c[1];"function"==typeof d?b[a]=d():(g[a]=c[2],g[a][j]=d)},c=d=function(){h.apply(null,arguments)},resolve=function(a,c){f[a]=!0;var d,e,h,i=c[j],k=[];if(i)for(e=i.length,d=0;e>d;d++)if(h=i[d],g[h]){if(f.hasOwnProperty(h))throw new Error('Cyclical reference: "'+a+'" referencing "'+h+'"');resolve(h,g[h]),delete g[h]}if(!b.hasOwnProperty(a)){for(d=0;e>d;d++)h=i[d],k.push(b.hasOwnProperty(h)&&b[h]);b[a]=c.apply(null,k)}delete f[a]},e=function(){for(var a in g)resolve(a,g[a])},c}(),c("toArray",["isArguments","isArray","isUndefined"],function(a,b,c){var d=function(d){if(a(d))return Array.prototype.slice.call(d,0)||[];try{if(b(d))return d;if(!c(d))return[].concat(d)}catch(e){}return[]};return d}),c("dg.api",["isMatch","apply","toArray","sort","dispatcher","matchAll"],function(b,c,d,e,f,g){a.isMatch=b,a.apply=c,a.dispatcher=f,a.matchAll=g,a.array={toArray:d,sort:e}}),c("isRegExp",function(){var a=function(a){return"[object RegExp]"===Object.prototype.toString.call(a)};return a}),c("isDate",function(){var a=function(a){return a instanceof Date};return a}),c("apply",["isFunction"],function(a){return function(b,c,d){if(a(b)){switch(d=d||[],d.length){case 0:return b.call(c);case 1:return b.call(c,d[0]);case 2:return b.call(c,d[0],d[1]);case 3:return b.call(c,d[0],d[1],d[2]);case 4:return b.call(c,d[0],d[1],d[2],d[3]);case 5:return b.call(c,d[0],d[1],d[2],d[3],d[4]);case 6:return b.call(c,d[0],d[1],d[2],d[3],d[4],d[5])}return b.apply(c,d)}}}),c("isFunction",function(){var a=function(a){return"function"==typeof a};return a}),c("isMatch",["isRegExp","isDate"],function(a,b){function c(e,f){var g;if(e===f)return!0;if("object"==typeof f){if(g=typeof e,-1!==d.indexOf(g)){if(a(f)&&!f.test(e+""))return!1;if(b(f))return b(e)&&f.getTime()===e.getTime()?!0:!1}if(e instanceof Array&&void 0!==f[0]){for(var h=0;h<e.length;h+=1)if(c(e[h],f[0]))return!0;return!1}for(var i in f)if(f.hasOwnProperty(i)){if(void 0===e[i]&&!e.hasOwnProperty(i))return!1;if(!c(e[i],f[i]))return!1}return!0}return"function"==typeof f?!!f(e):!1}var d=["string","number","boolean"];return c}),c("isArguments",["toString"],function(a){var b=function(b){var c=String(b),d="[object Arguments]"===c;return d||(d="[object Array]"!==c&&null!==b&&"object"==typeof b&&"number"==typeof b.length&&b.length>=0&&(!b.callee||"[object Function]"===a.call(b.callee))),d};return b}),c("isArray",function(){Array.prototype.__isArray=!0,Object.defineProperty(Array.prototype,"__isArray",{enumerable:!1,writable:!0});var a=function(a){return a?!!a.__isArray:!1};return a}),c("isUndefined",function(){var a=function(a){return"undefined"==typeof a};return a}),c("sort",function(){function a(a,c,d,e){var f,g=a[d-1],h=c,i=0;for(f=c;d-1>f;f+=1)i=e(a[f],g),0>i&&(f!==h&&b(a,f,h),h+=1);return e(a[h],g)&&b(a,h,d-1),h}function b(a,b,c){var d=a[b];return a[b]=a[c],a[c]=d,a}function c(b,d,e,f){if(e>d){var g=a(b,d,e,f);c(b,d,g,f),c(b,g+1,e,f)}return b}return function(a,b){var d=c(a,0,a.length,b);return d}}),c("dispatcher",["apply","isFunction"],function(a,b){function c(a){this.type=a,this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1}function d(a){if(!a)throw Error("event cannot be undefined")}c.prototype.preventDefault=function(){this.defaultPrevented=!0},c.prototype.stopPropagation=function(){this.propagationStopped=!0},c.prototype.stopImmediatePropagation=function(){this.immediatePropagationStopped=!0},c.prototype.toString=function(){return this.type};var e=function(e,f,g){function h(a,b){d(a);var c,e;e=o[a],e&&(b?(c=e.indexOf(b),-1!==c&&e.splice(c,1)):e.length=0)}function i(a,c){return b(c)?(d(a),o[a]=o[a]||[],o[a].push(c),function(){h(a,c)}):void 0}function j(c,g){function j(){h(c,j),a(g,f||e,arguments)}return b(g)?(d(c),i(c,j)):void 0}function k(a,b){d(a);var c,e="*";return a||b?(c=[],o[e]&&(c=o[e].concat(c)),o[a]&&(c=o[a].concat(c)),c):o}function l(){o={}}function m(b,c){return b&&a(b,e,c)}function n(a){d(a);var b,e=k(a,!0),f=e.length,a="object"==typeof a?a:new c(a);if(f)for(arguments[0]=a,b=0;f>b;b+=1)a.immediatePropagationStopped||m(e[b],arguments);return a}if(e&&e.on&&e.on.dispatcher)return e;e=e||{};var o={};return i.dispatcher=!0,f&&g?(e.on=f[g.on]&&f[g.on].bind(f),e.off=f[g.off]&&f[g.off].bind(f),e.once=f[g.once]&&f[g.once].bind(f),e.dispatch=e.fire=f[g.dispatch].bind(f)):(e.on=i,e.off=h,e.once=j,e.dispatch=e.fire=n),e.getListeners=k,e.removeAllListeners=l,e};return e}),c("matchAll",["isMatch"],function(a){function b(b,c){for(var d=[],e=0;e<b.length;e+=1)a(b[e],c)&&d.push(b[e]);return d}return b}),e()}(this.util||{},function(){return exports}()),exports.errors={E1000:"E1000",E1001:"E1001",E1002:"E1002",E1101:"E1101",E1102:"E1102"};var module,isIOS=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g);try{module=angular.module("ux",["ng"])}catch(e){module=angular.module("ux")}exports.datagrid={version:"1.4.6",isIOS:isIOS,states:{BUILDING:"datagrid:building",READY:"datagrid:ready"},events:{ON_INIT:"datagrid:onInit",ON_LISTENERS_READY:"datagrid:onListenersReady",ON_READY:"datagrid:onReady",ON_STARTUP_COMPLETE:"datagrid:onStartupComplete",ON_BEFORE_RENDER:"datagrid:onBeforeRender",ON_AFTER_RENDER:"datagrid:onAfterRender",ON_BEFORE_UPDATE_WATCHERS:"datagrid:onBeforeUpdateWatchers",ON_AFTER_UPDATE_WATCHERS:"datagrid:onAfterUpdateWatchers",ON_BEFORE_DATA_CHANGE:"datagrid:onBeforeDataChange",ON_AFTER_DATA_CHANGE:"datagrid:onAfterDataChange",ON_BEFORE_RENDER_AFTER_DATA_CHANGE:"datagrid:onBeforeRenderAfterDataChange",ON_RENDER_AFTER_DATA_CHANGE:"datagrid:onRenderAfterDataChange",ON_ROW_TEMPLATE_CHANGE:"datagrid:onRowTemplateChange",ON_SCROLL:"datagrid:onScroll",ON_BEFORE_RESET:"datagrid:onBeforeReset",ON_AFTER_RESET:"datagrid:onAfterReset",ON_AFTER_HEIGHTS_UPDATED:"datagrid:onAfterHeightsUpdated",ON_AFTER_HEIGHTS_UPDATED_RENDER:"datagrid:onAfterHeightsUpdatedRender",ON_BEFORE_ROW_DEACTIVATE:"datagrid:onBeforeRowDeactivate",ON_AFTER_ROW_ACTIVATE:"datagrid:onAFterRowActivate",ON_ROW_COMPILE:"datagrid:onRowCompile",ON_SCROLL_TO_TOP:"datagrid:onScrollToTop",ON_SCROLL_TO_BOTTOM:"datagrid:onScrollToBottom",RESIZE:"datagrid:resize",UPDATE:"datagrid:update",SCROLL_TO_INDEX:"datagrid:scrollToIndex",SCROLL_TO_ITEM:"datagrid:scrollToItem",SCROLL_INTO_VIEW:"datagrid:scrollIntoView",LOG:"datagrid:log",INFO:"datagrid:info",WARN:"datagrid:warn",ERROR:"datagrid:error"},getGrid:function(a){for(var b;a;){if(a.datagrid)return a.datagrid;if(a.$$childHead&&(b=exports.datagrid.getGrid(a.$$childHead)))return b;a=a.$$nextSibling}return null},throwError:function(a){window.console&&console.warn&&console.warn(a)},options:{async:!0,updateDelay:100,creepRender:{enable:!0},creepStartDelay:1e3,cushion:-100,chunks:{detachDom:null,size:50,chunkClass:"datagrid-chunk",chunkDisabledClass:"datagrid-chunk-disabled",chunkReadyClass:"datagrid-chunk-ready"},scrollModel:{speed:5,manual:!0,simulateClick:!1,preventTouchMove:!1},compiledClass:"compiled",uncompiledClass:"uncompiled",contentClass:"datagrid-content",rowClass:"datagrid-row",renderThreshold:1,renderThresholdWait:50,renderWhileScrolling:!1,creepLimit:500,smartUpdate:!0,readyToRenderRetryMax:10,minHeight:100},coreAddons:[]},module.factory("gridAddons",["$injector",function(a){function b(b,c){for(var d,e,f=0,g=b.length;g>f;){if(d=a.get(b[f]),!("function"==typeof d||d instanceof Array))throw new Error("Addons expect a function ($injector array supported) to pass the grid instance to.");e=a.invoke(d,c,{inst:c}),f+=1}}return function(a,c){c=c instanceof Array?c:c&&c.replace(/,/g," ").replace(/\s+/g," ").split(" ")||[],a.addons&&(c=a.addons=a.addons.concat(c)),b(c,a)}}]),exports.css=function(){function a(a){return b(a)||(j[a]=c(a)),b(a)}function b(a){return j[a]}function c(a){if(document.styleSheets&&0!==document.getElementsByTagName(l.head).length){var b,c,d,e;if(document.styleSheets.length>0)for(d=0;d<document.styleSheets.length&&(document.styleSheets[d].disabled||(e=document.styleSheets[d].media,c=typeof e,c===l.string?(""===e||-1!==e.indexOf(l.screen))&&(b=document.styleSheets[d]):c===l.object&&(""===e.mediaText||-1!==e.mediaText.indexOf(l.screen))&&(b=document.styleSheets[d]),"undefined"==typeof b));d++);var f=document.createElement("style");f.type="text/css",f.title=a,document.getElementsByTagName(l.head)[0].appendChild(f);var g=document.styleSheets.length-1;return b=document.styleSheets[g],{name:a,styleSheet:b}}}function d(a){for(var b=j[a],c=document.styleSheets.length,d=0;c>d;d+=1)document.styleSheets[d]===b.styleSheet&&document.styleSheets.splice(d,1);delete j[a],b=null}function e(c,d,e){var f,g=b(c)||a(c),h=g.styleSheet;if(h.addRule){for(f=0;f<h.rules.length;f++)if(h.rules[f].selectorText&&h.rules[f].selectorText.toLowerCase()===d.toLowerCase())return void(h.rules[f].style.cssText=e);if(h.addRule(d,e),h.rules[h.rules.length-1].cssText===d+" { }")throw new Error("CSS failed to write")}else if(h.insertRule){for(f=0;f<h.cssRules.length;f++)if(h.cssRules[f].selectorText&&h.cssRules[f].selectorText.toLowerCase()===d.toLowerCase())return void(h.cssRules[f].style.cssText=e);h.insertRule(d+"{"+e+"}",0)}}function f(a){var b,c,d,e,f;if(-1!==a.indexOf("{")||-1!==a.indexOf("}"))return null;if(k[a])return k[a];for(b=0,c=document.styleSheets.length;c>b;b+=1)if(d=document.styleSheets[b],e=d.rules||d.cssRules,f=g(e,a))return f;return null}function g(a,b){var c,d,e,f;if(a)for(c=0,d=a.length;d>c;c+=1){if(e=a[c],e.cssRules&&(f=g(e.cssRules,b)))return f;if(e.selectorText){var h="(\b)*"+b.replace(".","\\.")+"([^-a-zA-Z0-9]|,|$)",i=e.selectorText.match(h);if(i&&-1!==i.indexOf(b))return k[b]=e.style,e.style}}return null}function h(a,b){var c=f(a);return c&&void 0!==c[b]?c[b]:null}function i(a,b,c){var d=f(a);d[b]=c}var j={},k={},l={head:"head",screen:"screen",string:"string",object:"object"};return{createdStyleSheets:[],createStyleSheet:c,createClass:e,getCSSValue:h,setCSSValue:i,getSelector:f,removeStyleSheet:d}}(),exports.each=each,exports.filter=filter,exports.extend=extend,function(){"use strict";var a=0;exports.uid=function(){a+=1;for(var b=a.toString(36).toUpperCase();b.length<6;)b="0"+b;return b}}(),exports.logWrapper=function(a,b,c,d){function e(a,c){"function"==typeof a&&f(a,b,c)}var f=exports.util.apply;return c=c||"black",b.$logName=a,b.log=b.info=b.warn=b.error=function(){},b.log=function(){var b=[exports.datagrid.events.LOG,a,c].concat(exports.util.array.toArray(arguments));d.logger?f(d.logger.log,d.logger,b):e(d,b)},b.info=function(){var b=[exports.datagrid.events.INFO,a,c].concat(exports.util.array.toArray(arguments));d.logger?f(d.logger.info,d.logger,b):e(d,b)},b.warn=function(){var b=[exports.datagrid.events.WARN,a,c].concat(exports.util.array.toArray(arguments));d.logger?f(d.logger.warn,d.logger,b):e(d,b)},b.error=function(){var b=[exports.datagrid.events.ERROR,a,c].concat(exports.util.array.toArray(arguments));d.logger?f(d.logger.error,d.logger,b):e(d,b)},b.destroyLogger=function(){d.logger&&(d.log("destroy"),d.logger.destroy(),d.logger=null)},b},exports.datagrid.Flow=Flow,module.directive("uxDatagrid",["$compile","gridAddons","$timeout",function(a,b,c){return{restrict:"AE",scope:!0,link:{pre:function(d,e,f){var g=new Datagrid(d,e,f,a,c);each(exports.datagrid.coreAddons,function(a){exports.util.apply(a,g,[g])}),b(g,f.addons)},post:function(a,b,c){a.datagrid.start()}}}}]),exports.datagrid.coreAddons.chunkModel=function(a){function b(){return x}function c(b,d,e,f){for(var g,h,i=0,j=b.length,k=new ChunkArray(a.options.chunks.detachDom);j>i;)h=b[i],i%d===0&&(g&&g.updateHeight(a.templateModel,y),g=new ChunkArray(a.options.chunks.detachDom),g.min=h.min||i,g.templateModel=a.templateModel,g.templateStart=e,g.templateEnd=f,g.parent=k,g.index=k.length,k.push(g)),h instanceof ChunkArray&&(h.parent=g,h.index=g.length),g.push(h),g.max=h.max||i,i+=1;return g&&g.updateHeight(a.templateModel,y),k.min||(k.min=k[0]?k[0].min:0,k.max=k[k.length-1]?k[k.length-1].max:0,k.templateStart=e,k.templateEnd=f,k.updateHeight(a.templateModel,y),k.dirtyHeight=!1),k.length>d?c(k,d,e,f):k}function d(b){var c,d;void 0===b||a.options.chunks.detachDom?x&&(x.forceHeightReCalc(a.templateModel,y),x.updateHeight(a.templateModel,y,1,!0),x.detachDom&&x.updateDomHeight(1)):(c=i(b,x),d=e(c,x),d.updateHeight(a.templateModel,y,-1,!0))}function e(a,b){for(var c;a.length;)c=a.shift(),b[c]instanceof ChunkArray&&(b=b[c]);return b}function f(a,b,d,e,f){return D.log("chunkDom"),A=f,z=b,y=a,B=d,C=e,x=c(a,b,d,e),t(x),x.updateDomHeight(1),f}function g(a){if(y.length!==a.length)return f(a,z,B,C,A);for(var b=0,c=a.length;c>b;)h(b,a[b]),b+=1}function h(a,b){var c=i(a,x),d=c.pop(),e=l(c);e&&e[d]&&(e[d]=b,e.dirtyHeight=!0),y[a]=b}function i(a,b,c){if(!b)return[];var d,e=0,f=b.length;for(c=c||[];f>e;){if(d=b[e],!(d instanceof ChunkArray)){c.push(a%z);break}if(a>=d.min&&a<=d.max){c.push(e),i(a,d,c);break}e+=1}return c}function j(a){var b=i(a,x),c=p(b);
return c&&c.length&&void 0===c.attr("row-id")&&c.attr("row-id",a),c}function k(a){if(x){var b=i(a,x);return m(b)}}function l(a){for(var b=a.slice(0),c=x;b.length;)c=c[b.shift()];return c}function m(a,b){for(var c,d=0,e=a.slice(0),f=x,g=A;d<e.length;)c=e.shift(),!b||f.rendered&&!n(f)||(b(g,f),t(f)),e.length||r(f),f=f[c],g=f.rendered||angular.element(g.children()[c]);return g}function n(a){var b=!a.hasChildChunks()&&a.length&&a.rendered&&a.rendered.children().length!==a.length;return b&&D.info("recompile chunk %s",a.getId()),b}function o(b,c){var d,e,f=0;if(b.html(c.getChildrenStr(!1,z)),d=b.children(),c.rendered=b,c.hasChildChunks())for(e=d.length;e>f;)c[f].dom=d[f],f+=1;c.detachDom&&c.dirtyHeight&&c.updateDomHeight(),exports.each(d,q),c.hasChildChunks()?-1!==d[0].className.indexOf(a.options.chunks.chunkClass)&&d.addClass(a.options.chunks.chunkReadyClass):c.rendered.hasClass(a.options.chunks.chunkReadyClass)||c.rendered.addClass(a.options.chunks.chunkReadyClass)}function p(a){return m(a,o)}function q(a){if(a){var b=window.getComputedStyle(a);if(b)return b.getPropertyValue("top")}}function r(b){return b.compiled||(b.compiled=s(b),b.compiled&&(b.parent&&r(b.parent),a.flow.add(v))),b.compiled}function s(b){var c,d;if(b[0]instanceof ChunkArray){for(c=0,d=b.length;d>c;){if(!b[c].compiled)return!1;c+=1}return!0}for(c=b.min,d=b.max;d>c;){if(!a.isCompiled(c))return!1;c+=1}return!0}function t(b){b.updateDom(a.options.chunks.chunkDisabledClass)}function u(a,b,c){D.log("reset"),E.length=0,a=a||[],x&&(x.destroy(),x=null,A=null,y=null),f(a,z,B,C,b)}function v(){var b=a.values.activeRange,c=a.options.chunks;x.enableRange(b.min,b.max,c.chunkDisabledClass),c.detachDom&&t(x)}function w(){u(),x=null,y=null,z=null,A=null,B=null,C=null,E.length=0,E=null,a.chunkModel=null,D.destroyLogger(),D=null,a=null}var x,y,z,A,B,C,D=exports.logWrapper("chunkModel",{},"purple",a),E=[];return a.flow.unique(t),D.chunkDom=f,D.getChunkList=b,D.getRowIndexes=function(a){return i(a,x)},D.getItemByIndexes=l,D.getRow=j,D.getExistingRow=k,D.reset=u,D.updateRow=h,D.updateList=g,D.updateAllChunkHeights=d,D.getRowIndexFromIndexes=getRowIndexFromIndexes,D.destroy=w,a.scope.$on(exports.datagrid.events.ON_AFTER_UPDATE_WATCHERS,v),exports.util.dispatcher(D),a.chunkModel=D,D},exports.datagrid.coreAddons.push(exports.datagrid.coreAddons.chunkModel),ChunkArray.uid=0,ChunkArray.DETACHED="chunkArray:detached",ChunkArray.ATTACHED="chunkArray:attached",ChunkArray.prototype=[],ChunkArray.prototype.getStub=function(a){return this.templateStartWithPos||this.createDomTemplates(),this.templateStartWithPos+a+this.templateEnd},ChunkArray.prototype.inRange=function(a){return a>=this.min&&a<=this.max},ChunkArray.prototype.rangeOverlap=function(a,b,c){var d=!1;for(c=c>0?c:0,a-=c,b+=c;b>=a;){if(this.inRange(a)){d=!0;break}a+=1}return d},ChunkArray.prototype.each=function(a,b){for(var c=0,d=this.length;d>c;)exports.util.apply(a,this[c],b),c+=1},ChunkArray.prototype.getChildrenStr=function(a,b){for(var c,d=0,e=this.length,f="",g=this;e>d;)g[d]instanceof ChunkArray?f+=g[d].getStub(a?g[d].getChildrenStr(a):"",b):(c=getRowIndexFromIndexes(g._id+"."+d,b),f+=this.templateModel.getTemplate(g[d]).template),d+=1;return f},ChunkArray.prototype.updateHeight=function(a,b,c,d){var e,f=0,g=0;if(this[0]instanceof ChunkArray)for(e=this.length;e>f;)1===c&&this[f].updateHeight(a,b,c,d),g+=this[f].height,f+=1;else g=a.getHeight(b,this.min,this.max);this.height!==g?(this.dirtyHeight=!0,this.height=g):this.rendered,-1==c&&this.dirtyHeight&&this.parent&&this.parent.updateHeight(a,b,c,d),d&&this.dirtyHeight&&this.updateDomHeight()},ChunkArray.prototype.getPreviousSibling=function(){var a,b;return this.parent&&(b=this.index-1,a=this.parent[b],a&&a.index===this.index-1||this.parent.parent&&(a=this.parent.getPreviousSibling(),a&&(a=a.last()))),a},ChunkArray.prototype.getNextSibling=function(){var a,b;return this.parent&&(b=this.index+1,a=this.parent[b],a&&a.index===this.index+1||this.parent.parent&&(a=this.parent.getNextSibling(),a&&(a=a.first()))),a},ChunkArray.prototype.first=function(){return this[0]},ChunkArray.prototype.last=function(){return this[this.length-1]},ChunkArray.prototype.calculateTop=function(){var a,b=0;return this.index&&this.parent&&(a=this.getPreviousSibling(),a&&(b=a.top+a.height)),this.top=b,this.top},ChunkArray.prototype.forceHeightReCalc=function(a,b){var c,d=0,e=0;if(this[0]instanceof ChunkArray)for(c=this.length;c>d;)e+=this[d].forceHeightReCalc(a,b),d+=1;else e=a.getHeight(b,this.min,this.max);return this.height!==e&&(this.height=e,this.detachDom?this.dirtySiblings():this.setDirtyHeight()),this.height},ChunkArray.prototype.setDirtyHeight=function(){for(var a=this;a;)a.dirtyHeight=!0,a=a.parent},ChunkArray.prototype.dirtySiblings=function(){if(this.dirtyHeight=!0,this.parent){for(var a=0,b=this.length;b>a;)this[a].dirtyHeight=!0,a+=1;this.parent.dirtySiblings()}},ChunkArray.prototype.getId=function(){if(this._index!==this.index||!this._id){var a=this,b="";for(this._index=this.index;a;)b="."+a.index+b,a=a.parent;this._id=b.substr(1,b.length)}return this._id},ChunkArray.prototype.hasChildChunks=function(){return this._hasChildChunks||(this._hasChildChunks=this.first()instanceof ChunkArray),this._hasChildChunks},ChunkArray.prototype.enableRange=function(a,b,c){this.rangeOverlap(a,b,this.detachDom)?this.enable(c):this.disable(c),this.hasChildChunks()&&this.each(this.enableRange,[a,b,c])},ChunkArray.prototype.enable=function(a){this.enabled||(this.enabled=!0,this.updateDom(a),this.parent&&this.parent.enable(a))},ChunkArray.prototype.disable=function(a){var b,c=0;if(this.compiled){if(this.hasChildChunks())for(b=this.length;b>c;)this[c].disable(a),c+=1;this.enabled&&(this.enabled=!1,this.updateDom(a))}},ChunkArray.prototype.updateDom=function(a){this.rendered&&(this.compiled&&!this.rendered.attr("compiled")&&this.rendered.attr("compiled",!0),this.detachDom?this.enabled?this.detached&&(this.detached=!1,this.parent.rendered.append(this.rendered)):this.enabled||this.detached||this.parent&&this.parent.compiled&&this.rendered.parent().length&&(this.detached=!0,this.rendered.remove(void 0,!0)):(this.rendered.attr("enabled",this.enabled),this.enabled?(this.rendered.removeAttr("disabled"),this.rendered.removeAttr("read-only"),this.rendered.removeClass(a)):(this.rendered.attr("disabled","disabled"),this.rendered.attr("read-only",!0),this.rendered.addClass(a))),this.each(this.updateDom,[a]))},ChunkArray.prototype.updateDomHeight=function(a){var b=this.rendered&&this.rendered[0]||this.dom;b?(this.dirtyHeight=!1,this.mode===ChunkArray.DETACHED&&(this.calculateTop(),b.style.top=this.top+"px"),b.style.height=this.height+"px"):this.createDomTemplates(),-1===a&&this.parent?this.parent.updateDomHeight(a):a&&this.hasChildChunks()&&this.each(this.updateDomHeight,[a])},ChunkArray.prototype.createDomTemplates=function(){if(!this.templateReady&&this.templateStart){var a=this.templateStart.substr(0,this.templateStart.length-1)+' style="';this.mode===ChunkArray.DETACHED&&(this.calculateTop(),a+="position:absolute;top:"+this.top+"px;left:0px;"),this.templateStartWithPos=a+"width:100%;height:"+this.height+'px;" chunk-id="'+this.getId()+'" range="'+this.min+":"+this.max+'">',this.templateReady=!0}},ChunkArray.prototype.children=function(){var a=[];this.each(function(){a.push(this.rendered)},[])},ChunkArray.prototype.decompile=function(a){this.hasChildChunks()?this.each("decompile",[a]):this.rendered&&(this.rendered.children().remove(),this.rendered.removeClass(a))},ChunkArray.prototype.destroy=function(){for(this.hasChildChunks()&&this.each(this.destroy),this.templateStart="",this.templateEnd="",this.templateModel=null,this.rendered=null,this.dom=null,this.parent=null;this.length;)this.pop();this.length=0},exports.datagrid.events.ON_RENDER_PROGRESS="datagrid:onRenderProgress",exports.datagrid.events.STOP_CREEP="datagrid:stopCreep",exports.datagrid.events.ENABLE_CREEP="datagrid:enableCreep",exports.datagrid.events.DISABLE_CREEP="datagrid:disableCreep",exports.datagrid.coreAddons.creepRenderModel=function(a){function b(b){if(a.scope.$root.$$phase)return!1;var c=a.getScope(b);return c&&c.$digested||a.forceRenderScope(b),!0}function c(){var b={count:0};return each(a.scopes,d,b),b.count>=a.rowsLength&&x.disable(),{count:b.count,len:a.rowsLength}}function d(a,b,c,d){d.count+=a?1:0}function e(b,c,d){a.values.touchDown||(s=!1,t=Date.now()+a.options.renderThreshold,y=b,z=c,h(i,d))}function f(b,c){var d=exports.util.array.toArray(arguments);return d.splice(0,2),a.options.async?(clearTimeout(r),r=setTimeout(function(){exports.util.apply(b,null,d)},c)):exports.util.apply(b,this,d),r}function g(b,c){for(;b>=0&&b<a.rowsLength&&a.isCompiled(b);)b+=c;return b>=0&&b<a.rowsLength?b:c>0?a.rowsLength:-1}function h(c,d){var e,f=Date.now();t>f&&j()?(e=a.templateModel.hasVariableRowHeights(),y=d?y:g(y,-1),y>=0&&b(y)&&d&&(y-=1),z=d?z:g(z,1),z!==a.rowsLength&&b(z)&&d&&(z+=1),h(c,d),e&&n()):c()}function i(){if(k(),j()){w+=1,a.values.touchDown||a.values.speed||!j()||l(y,z);var b=c();b!==u&&a.dispatch(exports.datagrid.events.ON_RENDER_PROGRESS,b)}else w=0,x.disable(),u=1,a.dispatch(exports.datagrid.events.ON_RENDER_PROGRESS,1)}function j(){return!!(y>-1||z<a.rowsLength)}function k(){t=0,clearTimeout(v),clearTimeout(r),v=0}function l(b,c,d,g){k(),w<a.options.creepLimit&&(v=f(e,d||a.options.renderThresholdWait,b,c,g))}function m(b,c){l(y,z,a.options.creepStartDelay,c)}function n(){B=!0;var b=a.getRowOffset(C)+D;a.scrollModel.scrollTo(b,!0),B=!1}function o(b){B||(a.templateModel.hasVariableRowHeights()&&(C=a.getOffsetIndex(a.values.scroll),D=a.values.scroll-a.getRowOffset(C)),k())}function p(a,b,c){w=0,y=b.started||0,z=b.ended||0,m(a,c)}function q(b){o(b),a.options.creepRender&&a.options.creepRender.enable!==!1&&x.enable()}var r,s,t,u,v=0,w=0,x=exports.logWrapper("creepModel",{},"blue",a),y=0,z=0,A=[],B=!1,C=0,D=0;x.stop=k,x.destroy=function(){x.disable(),k(),a=null,x=null},x.enable=function(){A.length||(A.push(a.scope.$on(exports.datagrid.events.BEFORE_VIRTUAL_SCROLL_START,o)),A.push(a.scope.$on(exports.datagrid.events.ON_VIRTUAL_SCROLL_UPDATE,o)),A.push(a.scope.$on(exports.datagrid.events.ON_TOUCH_DOWN,o)),A.push(a.scope.$on(exports.datagrid.events.ON_SCROLL_START,o)),A.push(a.scope.$on(exports.datagrid.events.ON_AFTER_UPDATE_WATCHERS,p)))},x.disable=function(){for(k(),x.info("creep Disabled");A.length;)A.pop()()},a.unwatchers.push(a.scope.$on(exports.datagrid.events.DISABLE_CREEP,x.disable)),a.unwatchers.push(a.scope.$on(exports.datagrid.events.ON_BEFORE_RESET,q)),a.unwatchers.push(a.scope.$on(exports.datagrid.events.STOP_CREEP,k)),a.creepRenderModel=x,a.options.creepRender&&a.options.creepRender.enable?x.enable():x.disable()},exports.datagrid.coreAddons.push(exports.datagrid.coreAddons.creepRenderModel),exports.datagrid.coreAddons.normalizeModel=function(a){function b(c,d,e,f,g){var h;return g=g.slice(0),g.push(d),c===f?g:c[a.grouped]&&c[a.grouped].length&&(h=ux.each(c[a.grouped],b,f,g),h&&h!==c[a.grouped])?h:void 0}function c(a,b,c,d){"replace"===d?a[b]=c:"insert"===d?a.splice(b,0,c):"remove"===d&&a.splice(b,1)}function d(b,d,g){for(var h,i,j=a.getOriginalIndexOfItem(f[d]),k=e;j.length;){if(i=j.shift(),h=k[i],!j.length){a.grouped&&k[0]&&k[0].hasOwnProperty(a.grouped)&&(k=k[0][a.grouped],j.push(k.length),i=k.length),c(k,i,b,g);break}a.grouped&&(k=h[a.grouped])}c(f,d,b,g)}var e,f,g=exports.logWrapper("normalizeModel",{},"grey",a);return a.normalize=function(b,c,d){b=b||[];var e=0,f=b.length;for(d=d||[];f>e;)d.push(b[e]),b[e]&&b[e][c]&&a.normalize(b[e][c],c,d),e+=1;return d},a.setData=function(b,c){return g.log("setData %s",b),e=b,f=c?a.normalize(b,c):b&&b.slice(0)||[]},a.getData=function(){return f},a.getOriginalData=function(){return e},a.getOriginalIndexOfItem=function(a){var c=ux.each(e,b,a,[]);return c&&c!==e?c:[]},a.getNormalizedIndex=function(b,c){for(var d=c||0;d<a.rowsLength;){if(a.data[d]===b)return d;d+=1}if(c)for(d=c;d>=0;){if(a.data[d]===b)return d;d-=1}return-1},g.replace=function(a,b){d(a,b,"replace")},g.insert=function(a,b){d(a,b,"insert")},g.remove=function(a){d(null,a,"remove")},g.move=function(b,c){var d=a.getRowItem(b);b>c?(g.remove(b),g.insert(d,c)):c>b&&(g.insert(d,c),g.remove(b))},g.destroy=function(){g.destroyLogger(),e=null,f=null,a.normalizeModel=null,a=null,g=null},a.normalizeModel=g,a},exports.datagrid.coreAddons.push(exports.datagrid.coreAddons.normalizeModel),exports.datagrid.events.ON_SCROLL_START="datagrid:scrollStart",exports.datagrid.events.ON_SCROLL_STOP="datagrid:scrollStop",exports.datagrid.events.ON_TOUCH_DOWN="datagrid:touchDown",exports.datagrid.events.ON_TOUCH_UP="datagrid:touchUp",exports.datagrid.events.ON_TOUCH_MOVE="datagrid:touchMove",exports.datagrid.coreAddons.scrollModel=function(a){function b(){m(),a.element.css("overflow")&&"visible"!==a.element.css("overflow")||a.element.css({overflow:"auto"}),A.log("addScrollListener"),c(),a.unwatchers.push(a.scope.$on(exports.datagrid.events.SCROLL_TO_INDEX,function(b,c){a.scrollModel.scrollToIndex(c,!0)})),a.unwatchers.push(a.scope.$on(exports.datagrid.events.SCROLL_TO_ITEM,function(b,c){a.scrollModel.scrollToItem(c,!0)})),a.unwatchers.push(a.scope.$on(exports.datagrid.events.SCROLL_INTO_VIEW,function(b,c){a.scrollModel.scrollIntoView(c,!0)})),f(),B=!0}function c(){A.log("addScrollListener"),D=!0,a.element[0].addEventListener("scroll",h)}function d(){a.options.scrollModel&&a.options.scrollModel.manual&&(H[1].enabled=!0),D&&(A.removeScrollListener(),D=!1),A.removeTouchEvents()}function e(){D||c(),f()}function f(){A.log("addTouchEvents");var b=a.getContent();exports.each(H,function(a){a.enabled&&(A.log("	add %s",a.event),b.bind(a.event,A[a.method]))})}function g(a){return a.touches||a.originalEvent.touches}function h(b){a.scrollModel.onUpdateScroll(b)}function i(){p=Date.now(),a.scrollModel.onScrollingStop()}function j(b){a.data[b-1]&&!a.isCompiled(b-1)&&a.forceRenderScope(b-1),a.data[b+1]&&!a.isCompiled(b+1)&&a.forceRenderScope(b+1)}function k(){D&&(A.log("onAfterHeightsUpdated force scroll to %s",a.values.scroll),a.element[0].scrollTop=a.values.scroll)}function l(){clearTimeout(n),A.destroyLogger(),m(),B&&(A.removeScrollListener(),A.removeTouchEvents()),A=null,a=null}var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=exports.logWrapper("scrollModel",{},"orange",a),B=!1,C=!0,D=!1,E=0,F=0,G=0,H=[{event:"touchstart",method:"onTouchStart",enabled:!0},{event:"touchmove",method:"onTouchMove",enabled:!1},{event:"touchend",method:"onTouchEnd",enabled:!0},{event:"touchcancel",method:"onTouchEnd",enabled:!0}];return A.fireOnScroll=function(){a.values.scroll!==o&&(o=a.values.scroll,a.dispatch(exports.datagrid.events.ON_SCROLL,a.values))},A.removeScrollListener=function(){A.log("removeScrollListener"),a.element[0].removeEventListener("scroll",h)},A.removeTouchEvents=function(){if(B){A.log("removeTouchEvents");var b=a.getContent();exports.each(H,function(a){A.log("	remove %s",a.event),b.unbind(a.event,A[a.method])})}},A.killEvent=function(a){a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.stopImmediatePropagation&&a.stopImmediatePropagation()},A.enable=function(a){C=!!a},A.onTouchStart=function(b){C&&(clearTimeout(z),a.values.touchDown=!0,s=q=g(b)[0].clientY||0,t=r=g(b)[0].clientX||0,a.values.scroll<0?a.values.scroll=0:a.values.scroll>E&&(a.values.scroll=E),u=a.values.scroll,v=0,w=0,a.dispatch(exports.datagrid.events.ON_TOUCH_DOWN,b))},A.onTouchMove=function(b){if(C){a.options.scrollModel&&a.options.scrollModel.preventTouchMove&&A.killEvent(b);var c=g(b)[0].clientY,d=g(b)[0].clientX,e=s-c,f=t-d;e!==v&&(A.setScroll(A.capScrollValue(u+e)),F=e-v,v=e),f!==w&&(A.setScroll(A.capScrollValue(u+e)),G=f-w,w=f),a.dispatch(exports.datagrid.events.ON_TOUCH_MOVE,F,e,v,G,f,w)}},A.onTouchEnd=function(b){if(C&&a.values.touchDown){a.values.touchDown=!1,a.dispatch(exports.datagrid.events.ON_TOUCH_UP,b),H[1].enabled&&(Math.abs(v)<2&&Math.abs(w)<2?A.click(b):(x=Date.now(),y=F*a.options.scrollModel.speed,A.scrollSlowDown(!0)));var c=a.element[0].scrollTop;0>c||a.getContentHeight()<a.getViewportHeight()?a.element[0].scrollTop=0:c>a.getContentHeight()-a.getViewportHeight()&&(a.element[0].scrollTop=a.getContentHeight()-a.getViewportHeight())}},A.scrollSlowDown=function(b){clearTimeout(z);var c,d,e=Math.abs(F)*a.options.scrollModel.speed,f=e-(Date.now()-x),g=y;y=A.easeOut(f,y,F||0,e),d=y-g,Math.abs(d)<5&&(f=0),f>0&&(c=A.capScrollValue(a.values.scroll+d),b||(a.element[0].scrollTop=c),z=setTimeout(A.scrollSlowDown,20))},A.easeOut=function(a,b,c,d){return-c*(a/=d)*(a-2)+b},A.click=function(b){if(a.options.scrollModel.simulateClick){a.options.scrollModel.simulateClick&&d&&!/(SELECT|INPUT|TEXTAREA)/i.test(d.tagName)&&A.killEvent(b);var c,d=b.target;if(!a.isDigesting(a.$scope)&&d&&!/(SELECT|INPUT|TEXTAREA)/i.test(d.tagName)){c=document.createEvent("MouseEvents"),c.initMouseEvent("click",!0,!0,b.view,1,d.screenX,d.screenY,d.clientX,d.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,null),c._constructed=!0;try{a.creepRenderModel.stop(),d.dispatchEvent(c)}catch(e){}}}},A.getScroll=function(b){return(b||a.element[0]).scrollTop},A.setScroll=function(b){var c,d=a.chunkModel.getChunkList();d&&d.height?a.getContentHeight()-a.getViewportHeight()>=b&&(a.element[0].scrollTop=b):c=a.scope.$on(exports.datagrid.events.ON_AFTER_RENDER,function(){c(),A.setScroll(b)}),a.values.scroll=b},A.onUpdateScroll=function(b){var c=a.scrollModel.getScroll(b.target||b.srcElement);a.values.scroll!==c&&(a.dispatch(exports.datagrid.events.ON_SCROLL_START,c),a.values.speed=c-a.values.scroll,a.values.absSpeed=Math.abs(a.values.speed),a.values.scroll=c,a.values.scrollPercent=(a.values.scroll/a.getContentHeight()*100).toFixed(2)),a.scrollModel.waitForStop(),A.fireOnScroll()},A.capScrollValue=function(b){var c;return a.getContentHeight()<a.getViewportHeight()?(a.log("	CAPPED scroll value from %s to 0",b),b=0):a.getContentHeight()-b<a.getViewportHeight()&&(c=a.getContentHeight()-a.getViewportHeight(),a.log("	CAPPED scroll value to keep it from scrolling past the bottom. changed %s to %s",b,c),b=c),b},A.scrollTo=function(b,c){return b=A.capScrollValue(b),b!==o?(a.scrollModel.setScroll(b),c?a.scrollModel.onScrollingStop():a.scrollModel.waitForStop(),!0):!1},A.clearOnScrollingStop=function(){A.onScrollingStop()},A.waitForStop=function(){var b=!1;clearTimeout(n),A.log("waitForStop scroll = %s",a.values.scroll),a.options.renderWhileScrolling&&Date.now()-(a.options.renderWhileScrolling>0||0)>p&&(b=!0),b||!a.flow.async&&!a.values.touchDown?i():n=setTimeout(i,a.options.updateDelay)},A.onScrollingStop=function(){A.log("onScrollingStop %s",a.values.scroll),A.checkForEnds(),a.values.speed=0,a.values.absSpeed=0,a.render(),A.fireOnScroll(),a.dispatch(exports.datagrid.events.ON_SCROLL_STOP,a.values),A.calculateBottomOffset()},A.scrollToIndex=function(b,c){A.log("scrollToIndex");var d=a.getRowOffset(b);return a.scrollModel.scrollTo(d,c),d},A.scrollToItem=function(b,c){A.log("scrollToItem");var d=a.getNormalizedIndex(b);return-1!==d?a.scrollModel.scrollToIndex(d,c):a.values.scroll},A.scrollIntoView=function(b,c){A.log("scrollIntoView");var d,e,f="number"==typeof b?b:a.getNormalizedIndex(b),g=a.getRowOffset(f);return j(f),g<a.values.scroll?a.scrollModel.scrollTo(g,c):(a.updateViewportHeight(),e=a.getViewportHeight(),d=a.templateModel.getTemplateHeight(a.getData()[f]),g>=a.values.scroll+e-d?a.scrollModel.scrollTo(g-e+d,c):!1)},A.scrollToTop=function(b){A.log("scrollToTop"),a.scrollModel.scrollTo(0,b)},A.scrollToBottom=function(b){A.log("scrollToBottom");var c=a.getContentHeight()-a.getViewportHeight();a.scrollModel.scrollTo(c>=0?c:0,b)},A.calculateBottomOffset=function(){if(a.rowsLength){var b=a.rowsLength-1;A.bottomOffset=E=a.getRowOffset(b)-a.getViewportHeight()+a.getRowHeight(b)}},A.checkForEnds=function(){a.values.scroll&&a.values.scroll>=E?a.dispatch(ux.datagrid.events.ON_SCROLL_TO_BOTTOM,a.values.speed):a.values.scroll<=0&&a.dispatch(ux.datagrid.events.ON_SCROLL_TO_TOP,a.values.speed)},m=a.scope.$on(exports.datagrid.events.ON_READY,b),a.unwatchers.push(a.scope.$on(exports.datagrid.events.ON_AFTER_HEIGHTS_UPDATED,k)),a.unwatchers.push(a.scope.$on(exports.datagrid.events.ON_BEFORE_RESET,d)),a.unwatchers.push(a.scope.$on(exports.datagrid.events.ON_AFTER_RESET,e)),a.unwatchers.push(a.scope.$on(ux.datagrid.events.ON_RENDER_AFTER_DATA_CHANGE,A.calculateBottomOffset)),A.destroy=l,a.scrollModel=A,a},exports.datagrid.coreAddons.push(exports.datagrid.coreAddons.scrollModel),exports.datagrid.coreAddons.templateModel=function(a){"use strict";function b(a){return a=a.replace(/\n/g,""),a=a.replace(/[\t ]+</g,"<"),a=a.replace(/>[\t ]+</g,"><"),a=a.replace(/>[\t ]+$/g,">")}var c=/\#{3}[\w\d\W]+\#{3}/gi,d=/\#{3}include:([\w\d\W]+)\#{3}/gi,e=/uncompiled\s?/;return a.templateModel=function(){function f(){return K||(K="$$template_"+a.uid),K}function g(){O.log("createTemplates");var b,c=a.element[0].getElementsByTagName("script"),d=c.length;for(d||M.length||a.throwError(exports.errors.E1102),b=0;d>b;b+=1)h(c[b]);for(;c.length;)a.element[0].removeChild(c[0])}function h(a){var c=l(a,"template-name")||N,d=l(a,"template-base")||null,e=l(a,"template-item");return j(b(angular.element(a).html()),c,e,d)}function i(a){exports.each(a,function(a){j(a.template,a.name,a.item,a.base)})}function j(c,d,e,f){var g,h=c,i=document.createElement("div");return i.className="grid-template-wrapper",c=O.prepTemplate(d,c,f),c=angular.element(c)[0],f||(c.className+=" "+a.options.rowClass+" "+a.options.uncompiledClass+" {{$status}}"),c.setAttribute("template",d),a.getContent()[0].appendChild(i),i.appendChild(c),c=b(i.innerHTML),g={name:d,item:e,template:c,originalTemplate:h,height:E(i.children[0])},O.log("template: %s %o",d,g),g.height||("none"===a.element.css("display")?O.warn("Datagrid was intialized with a display:'none' value. Templates are unable to calculate heights. Grid will not render correctly."):a.element[0].offsetHeight?a.throwError(exports.errors.E1101):a.throwError(exports.errors.E1000)),M[g.name]=g,M.push(g),a.getContent()[0].removeChild(i),J=0,g}function k(a,b,f){var g,h="";return f?(g=O.getTemplateByName(f),h=g.originalTemplate,h=h.replace(new RegExp("#{3}"+a+"#{3}","gi"),b)):-1!==b.indexOf("###include:")?b.replace(d,function(a,b){var c=O.getTemplateByName(b);return c&&c.template.replace(e,"")||""}):b.replace(c,"")}function l(a,b){var c=a.attributes["data-"+b]||a.attributes[b];return c&&c.value||""}function m(){return M}function n(a){return a.attr?a.attr("template"):a.getAttribute("template")}function o(a){return M[a]?M[a]:M[N]}function p(){var a,b;for(a in M)if(exports.util.apply(Object.prototype.hasOwnProperty,M,[a])&&(b=b||M[a].height,b!==M[a].height))return!0;return!1}function q(){var a=0,b=M.length;if(!J)for(;b>a;)J+=M[a].height,a+=1;return J/b}function r(){return M.length}function s(a){var b=O.getTemplate(a);return b?b.height:0}function t(a,b,c){var d=b,e=0;if(!a.length)return 0;for(;c>=d;)e+=O.getRowHeight(d),d+=1;return e}function u(a,b){var c=f();exports.util.apply(Object.prototype.hasOwnProperty,a,[c])||-1!==P.indexOf(a)||P.push(a),a[c]=b}function v(b,c,d){O.info("setTemplate %s %s",b,c);var e;"number"==typeof b?(e=a.data[b],x(b)):e=b;var f=O.getTemplate(e).name;O.setTemplateName(e,c),a.flow.add(a.dispatch,[exports.datagrid.events.ON_ROW_TEMPLATE_CHANGE,e,f,c,d],0)}function w(a,b){L[a]=b,Q=!0}function x(a){delete L[a],Q=!0}function y(){L={},Q=!0}function z(a){return!!L[a]}function A(b){var c,d,e=L.hasOwnProperty(b),f=O.getTemplateHeight(a.data[b]);if(R.variableRowHeights&&!e&&a.isCompiled(b)){if(c=a.getExistingRow(b),!c||!c.length)return f;d=c[0].offsetHeight,d!==L[b]&&d!==f&&(c[0].style.height=d+"px",L[b]=d,e=!0,Q=!0)}return e?L[b]:f}function B(){return!!R.variableRowHeights}function C(){return Q}function D(){Q=!1}function E(a){var b=window.getComputedStyle(a);return a.offsetHeight+parseInt(b.marginTop,10)+parseInt(b.marginBottom,10)}function F(){for(var b,c,d,e=a.values.activeRange.min,f=a.values.activeRange.max-e,g={};f>e&&!Q;)L.hasOwnProperty(e)||(O.hasVariableRowHeights()?O.getRowHeight(e):(c=O.getTemplate(a.getData()[e]),g[c.name]||(b=a.getRowElm(e),d=O.calculateRowHeight(b[0]),d!==c.height&&(c.height=d,Q=!0)))),e+=1;Q&&(a.updateHeights(),D())}function G(a){delete a[f()]}function H(){exports.each(P,G),P.length=0}function I(){H(),O.destroyLogger(),O=null,M.length=0,M=null,P=null}var J,K,L,M=[],N="default",O=exports.logWrapper("templateModel",{},"teal",a),P=[],Q=!1,R=extend({},a.options.templateModel);return O.getTemplate=function(a){var b=a[f()]||a._template;return O.getTemplateByName(b)},O.defaultName=N,O.prepTemplate=k,O.createTemplates=g,O.createTemplatesFromData=i,O.getTemplates=m,O.getTemplateName=n,O.getTemplateByName=o,O.calculateRowHeight=E,O.templateCount=r,O.dynamicHeights=p,O.averageTemplateHeight=q,O.getHeight=t,O.getTemplateHeight=s,O.getRowHeight=A,O.hasDirtyHeights=C,O.clearDirtyHeights=D,O.hasVariableRowHeights=B,O.hasOverrideHeight=z,O.forceRowHeight=w,O.clearRowHeight=x,O.clearAllRowHeights=y,O.setTemplate=v,O.setTemplateName=u,O.updateTemplateHeights=F,O.getTemplatesKey=f,O.destroy=I,O}(),a.templateModel},exports.datagrid.coreAddons.push(exports.datagrid.coreAddons.templateModel);
//# sourceMappingURL=angular-ux-datagrid.min.js.map
}(this.ux = this.ux || {}, function() {return this;}()));
